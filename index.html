<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Signal Lab</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
  --glass-bg: rgba(255,255,255,.75);
  --glass-border: rgba(255,255,255,.6);
  --glass-shadow: 0 30px 80px rgba(0,0,0,.35);
  --blur: blur(22px);
  --ease-ios: cubic-bezier(.16,1,.3,1);
  --text: #1d1d1f;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display";
  color:var(--text);
  background:#f2f2f7;
}

/* ====== èƒŒæ™¯ ====== */
.mesh-bg{
  position:fixed;inset:0;z-index:-1;
  background:
    radial-gradient(circle at 15% 30%, #ffd6e8, transparent 40%),
    radial-gradient(circle at 85% 20%, #cce7ff, transparent 40%),
    radial-gradient(circle at 50% 80%, #e5dcff, transparent 50%);
  animation:bgmove 8s ease-in-out infinite alternate;
}
@keyframes bgmove{
  from{background-position:0% 0%}
  to{background-position:100% 100%}
}

/* ====== æ‰‹æœºç«¯çœŸæ­£å±…ä¸­ ====== */
.viewport{
  min-height:100svh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:
    env(safe-area-inset-top)
    16px
    env(safe-area-inset-bottom);
}

/* ====== ä¸»å¡ç‰‡ ====== */
.app{
  width:100%;
  max-width:380px;
  background:linear-gradient(135deg,rgba(255,255,255,.95),rgba(255,255,255,.7));
  backdrop-filter:var(--blur);
  border-radius:28px;
  box-shadow:var(--glass-shadow);
  padding:28px 22px;
  animation:enter .6s var(--ease-ios);
}
@keyframes enter{
  from{opacity:0;transform:translateY(24px) scale(.96)}
  to{opacity:1;transform:none}
}

/* ====== é¡¶éƒ¨ ====== */
.navbar{text-align:center;margin-bottom:18px}
.navbar h1{
  margin:0;font-size:20px;font-weight:700;
  display:flex;gap:8px;align-items:center;justify-content:center;
}
.status-dot{
  width:8px;height:8px;border-radius:50%;
  background:#34c759;box-shadow:0 0 10px #34c759;
  animation:breathe 2s infinite;
}
@keyframes breathe{
  50%{opacity:.5;transform:scale(.8)}
}
.count-text{
  margin-top:6px;
  font-size:12px;color:#6e6e73;
}

/* ====== å¡ç‰‡å— ====== */
.card{
  background:rgba(255,255,255,.55);
  backdrop-filter:blur(18px);
  border-radius:22px;
  padding:20px;
  margin-bottom:16px;
}
.card-header{
  font-size:15px;
  font-weight:700;
  margin-bottom:12px;
}

/* ====== è¡¨å• ====== */
.form-group{margin-bottom:12px}
.form-row{display:flex;gap:10px}

input,select{
  width:100%;
  padding:14px 16px;
  font-size:16px;
  border-radius:14px;
  border:none;
  background:rgba(255,255,255,.9);
  box-shadow:inset 0 0 0 1px rgba(0,0,0,.06);
  appearance:none;
}

/* ====== æŒ‰é’®ï¼ˆiOS é£ï¼‰ ====== */
.btn{
  width:100%;
  padding:15px;
  border-radius:16px;
  font-size:16px;
  font-weight:600;
  border:none;
  cursor:pointer;
  transition:.2s var(--ease-ios);
}
.btn:active{transform:scale(.96)}

.btn-submit{
  background:linear-gradient(180deg,#111,#000);
  color:#fff;
  box-shadow:0 14px 32px rgba(0,0,0,.35);
}
.btn-draw-male{
  background:rgba(0,122,255,.15);
  color:#0051a8;
  margin-bottom:10px;
}
.btn-draw-female{
  background:rgba(255,45,85,.15);
  color:#a8002a;
}

/* ====== ç›²ç›’åŠ¨ç”» ====== */
.blind-box-container{
  position:fixed;inset:0;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(18px);
  display:none;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  z-index:999;
}
.mystery-box{
  font-size:96px;
  animation:shake .8s var(--ease-ios) infinite;
}
@keyframes shake{
  0%{transform:rotate(0)}
  25%{transform:rotate(8deg)}
  75%{transform:rotate(-8deg)}
}
.loading-text{
  margin-top:18px;
  color:#fff;
  font-weight:600;
}

/* ====== ç»“æœ ====== */
.result-overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}
.result-box{
  background:rgba(255,255,255,.95);
  border-radius:24px;
  padding:26px 20px;
  text-align:center;
  animation:enter .5s var(--ease-ios);
  width:82%;
  max-width:320px;
}
.close-btn{
  position:absolute;
  top:12px;right:12px;
  width:28px;height:28px;
  border-radius:50%;
  background:rgba(0,0,0,.1);
  line-height:28px;
}
.res-avatar{font-size:54px}
.res-name{font-size:22px;font-weight:700}
.res-details{
  font-size:13px;
  color:#6e6e73;
  margin:8px 0 14px;
}
.res-contact{
  padding:14px;
  border-radius:14px;
  background:#fff;
  color:#007AFF;
  font-weight:600;
}
.tips{font-size:12px;color:#aaa;margin-top:10px}

.footer{
  text-align:center;
  font-size:12px;
  color:#aaa;
  margin-top:10px;
}
/* --- æ”¾åœ¨ style.css æœ€åº•éƒ¨ --- */

/* Toast æç¤ºæ¡†å®¹å™¨ */
#toast-container {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: none; /* åªæœ‰æ–‡å­—éƒ¨åˆ†å¯ç‚¹å‡»ï¼Œä¸é˜»æŒ¡ä¸‹æ–¹æ“ä½œ */
}

/* æç¤ºæ¡†æœ¬ä½“ */
.toast {
    background: rgba(0, 0, 0, 0.85);
    color: white;
    padding: 12px 24px;
    border-radius: 50px;
    font-size: 0.9rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    animation: slideDown 0.3s ease-out, fadeOut 0.3s ease-in 2.7s forwards;
    display: flex;
    align-items: center;
    gap: 8px;
    backdrop-filter: blur(4px);
}

/* æˆåŠŸæ ·å¼ */
.toast.success { border-left: 4px solid #10b981; }
/* é”™è¯¯æ ·å¼ */
.toast.error { border-left: 4px solid #ef4444; }

@keyframes slideDown {
    from { transform: translateY(-20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}
@keyframes fadeOut {
    to { opacity: 0; transform: translateY(-10px); }
}
</style>
</head>

<body>
<div class="mesh-bg"></div>

<div class="viewport">
  <div class="app">

    <div class="navbar">
      <h1><span class="status-dot"></span>Signal Lab</h1>
      <p class="count-text">å·²è¿æ¥ <span id="totalCount" style="color:#007AFF;font-weight:600">...</span> ä¸ªåŒé¢‘ä¿¡å·</p>
    </div>

    <!-- å‘å°„ -->
    <div class="card">
      <div class="card-header">ğŸ“¡ å‘å°„ä¿¡å·</div>
      <div class="form-group"><input id="nickname" placeholder="ä»£å· / æ˜µç§°"></div>
      <div class="form-row">
        <div class="form-group" style="flex:1.4">
          <select id="gender">
            <option value="ç”·">æˆ‘æ˜¯ç”·ç”Ÿ ğŸ‘¦</option>
            <option value="å¥³">æˆ‘æ˜¯å¥³ç”Ÿ ğŸ‘§</option>
          </select>
        </div>
        <div class="form-group"><input id="age" type="number" placeholder="å¹´é¾„"></div>
      </div>
      <div class="form-group"><input id="city" placeholder="åæ ‡ (å¦‚: åŒ—äº¬)"></div>
      <div class="form-group"><input id="contact" placeholder="å¾®ä¿¡å· (ä»…åŒ¹é…å¯è§)"></div>
      <button class="btn btn-submit" onclick="submitCard()">å‘å°„ä¿¡å·</button>
    </div>

    <!-- æ•æ‰ -->
    <div class="card">
      <div class="card-header">ğŸ” æ•æ‰ä¿¡å·</div>
      <button class="btn btn-draw-male" onclick="drawCard('ç”·')">æ•æ‰ç”·ç”Ÿ ğŸ‘¦</button>
      <button class="btn btn-draw-female" onclick="drawCard('å¥³')">æ•æ‰å¥³ç”Ÿ ğŸ‘§</button>
    </div>

    <div class="footer">Signal Lab Â© 2026<br>ç½‘ç»œäº¤å‹éœ€è°¨æ…</div>
  </div>
</div>

<!-- ç›²ç›’ -->
<div id="blindBoxAnim" class="blind-box-container">
  <div class="mystery-box">ğŸ</div>
  <div class="loading-text">æ­£åœ¨é”å®šä¿¡å·æº...</div>
</div>

<!-- ç»“æœ -->
<div id="resultOverlay" class="result-overlay" onclick="closeResult()">
  <div class="result-box" onclick="event.stopPropagation()">
    <div class="close-btn" onclick="closeResult()">Ã—</div>
    <div class="res-avatar" id="resIcon">ğŸ‰</div>
    <div class="res-name" id="resNick">--</div>
    <div class="res-details" id="resInfo">--</div>
    <div class="res-contact" id="resContact" onclick="copyContact()">å¾®ä¿¡å·</div>
    <div class="tips">ç‚¹å‡»å¤åˆ¶</div>
  </div>
</div>

<script src="app.js"></script>
<script>
function closeResult(){
  document.getElementById('resultOverlay').style.display='none'
}
</script>
<div id="toast-container"></div>
</body>
</html>
